<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Sollicitaties</title>
    <script
            src="https://code.jquery.com/jquery-3.4.1.js"
            integrity="sha256-WpOohJOqMqqyKL9FccASB9O0KwACQJpFTUBLTYOVvVU="
            crossorigin="anonymous"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"
            integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1"
            crossorigin="anonymous"></script>

</head>
<body>
<div class="content">
    <h1>Sollicitaties</h1>
    <section id="gallery">
        <div class="container">
            <div class="row">
                <div th:each="task : ${tasks}">
                    <table id="sollicitaties">

<!--                            <form action="#" th:action="@{/sollicitaties}" th:object="${task}" id="applicationform" method="get">-->
                        <form action="#" id="applicationform" th:action="@{/manager/saveSollicitaties}" th:object="${task}" method="post">
                            <tr>
                                <td id = "taskTitle" th:text="${task.titel}"></td>

                                <td th:each="user : ${task.users}">
                                <span  id = "userName" th:text="${user.username}"></span>
                                    <input type="hidden" id="userId" name="userId" th:value="${user.id}"/>
                                </td>

                                <td th:text ="${task.getTaskStatus()}"></td>
                                <td>

                                    <select name="status" id="status" required>
                                    <option value="">Geef status</option>
                                        <span th:each="status : ${statussen}">
                                    <option th:text="${status}" th:value="${status}"></option></span>
                                    </select>
                                </td>

                                <td><button type="submit" value="Opslaan" id="opslaanSolliciatie">
                                <input type="hidden" id="taskId" name="taskId" th:value="*{id}"/></button>
                                </td>
                                //let op: submit weghalen is ik toch Ajax wil gebruiken
                            </tr>
                        </form>


                     </table>

                </div>

            </div>
            </form>
        </div>
</section>
</div>

<!--<script>-->

<!--        var button = document.getElementById("opslaanSolliciatie").addEventListener("click",-->

<!--        function(event) {-->
<!--            event.preventDefault();-->
<!--            console.log("default prevenbted");-->
<!--            alert("jsjsjs");-->
<!--            var taskTitle = document.getElementById("taskTitle").value;-->
<!--            var userName = document.getElementById("userName").value;-->
<!--            var statusTask = document.getElementById("status").value;-->

<!--            var url = "/manager/saveSollicitaties";-->

<!--            var request = new XMLHttpRequest();-->
<!--            request.open('POST', url, true);-->
<!--            request.setRequestHeader('Content-Type', 'application/json');-->
<!--            console.log(request);-->


<!--            var data = {titel : taskTitle, userName: userName, status: statusTask};-->

<!--            console.log (JSON.stringify(data));-->

<!--            request.send(JSON.stringify(data));-->

<!--            request.onreadystatechange = function() {-->

<!--                if(request.readyState === XMLHttpRequest.DONE){-->

<!--                    if(request.status === 200){-->
<!--                        console.log(request.response);-->
<!--                    } else {-->
<!--                        alert("iets ging fout")-->
<!--                        console.log(request.status)-->
<!--                    }-->
<!--                    }-->
<!--                }-->
<!--        });-->

            // $("#applicationform").on("change", function () {
            //
            //     var formData = {
            //         taskTitle: $("#taskTitle").val(),
            //         userName: $("#userName").val(),
            //         statusTask: $(this).find(':selected').text();
            //
            // }
            //     payload = JSON.stringify(formData);
            //
            //     $.ajax({
            //         type: "get",
            //         contentType: "application/json; charset=utf-8",
            //         url: "/manager/saveSollicitaties/{status}",
            //         dataType: "json",
            //         data: payload
            //     }).done(function (response) {
            //             console.log (response)
            //         })
            // });
<!--// </script>-->
</body>
</html>